<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head runat="server">
    <!-- <meta property="og:url" content="https://link.jaamwater.com/homepage*" /> -->
    <!-- <meta property="og:title" content="Jaam Water" /> -->
    <!-- <meta property="og:description" content="order water from any location" />
    <meta property="og:image" content="https://isystemsdevops.github.io/DeepLink/jaamwaterAD.jpg" /> -->
    <!-- <meta property="og:type" content="website" /> -->
    <meta property="fb:app_id" content="164166812876671" />
    <meta property="al:ios:url" content="https://link.jaamwater.com/homepage*" />
    <meta property="al:ios:app_store_id" content="1594916133" />
    <meta property="al:ios:app_name" content="Jaam Water" />
    <meta property="al:android:url" content="https://link.jaamwater.com/homepage*" />
    <meta property="al:android:app_name" content="Jaam Water" />
    <meta property="al:android:class" content="io.miran.jaamwater.MainActivity" />
    <meta property="al:android:package" content="io.miran.jaamwater" />
    <meta property="al:description" content="order water from any location" />
    <meta property="al:image" content="https://isystemsdevops.github.io/DeepLink/jaamwaterAD.jpg" />
    <meta property="al:type" content="website" />
    <meta property="al:web:should_fallback" content="true" />
    <!-- <meta property="al:web:url" content="https://isys10devsection.net/applinkHomepageNew.aspx" /> -->
    <!-- <meta property="al:web:url" content="https://isystemsdevops.github.io/JaamWater/AppLink/AppLinkWeb.html" /> -->

    <title>Jaam Water Mobile Application</title>
    <style type="text/css">
        /* your CSS goes here*/
        .mdi-36px {
            font-size: 39px;
            margin-right: 10px;
        }


        .main-wrapper {
            box-sizing: border-box;
            width: 100vw;
            position:absolute;
            top:10vh;
        }
        
        .a-btn:hover{
            opacity:0.7;
        }
        .a-btn:focus{
            opacity:0.8;
        }

    </style>
    <link href="bootstrap/dist/css/style.min.css" rel="stylesheet" />
    <%--<script src="js/Font/fontAwesome.js"></script>--%>


     <script>
        async function redirectToStore() {
	    // Parse the query string to get the invitation code
            const urlParams = new URLSearchParams(window.location.search);
            const invitationCode = urlParams.get('invitationCode');
            console.log('Received invitation code:', invitationCode);
            const fibPayment = urlParams.get('fibPayment');
            console.log('Received fib payment:', fibPayment);

	    //if from payment gateway
	    if (fibPayment !== undefined && fibPayment !== null && fibPayment !== '') {
		//location.href="https://isystemsdevops.github.io/JaamWater/AppLink/AppLinkWeb.html";
	    	const soapApiUrl = 'https://isys10devsection.net/TInvoiceServiceV1_5.asmx?op=D15_Order_Insert_FIB_Status';
            	const soapAction = 'http://tempuri.org/D15_Order_Insert_FIB_Status'; 
            	// SOAP XML Request Body
                const soapRequest = `
                     <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
                     <soap:Body>
                        <D15_Order_Insert_FIB_Status xmlns="http://tempuri.org/">
                           <id>'123'</id>
                           <status>'success'</status>
                        </D15_Order_Insert_FIB_Status>
                     </soap:Body>
                     </soap:Envelope>
                `;
	    	try {
                    const response = await fetch(soapApiUrl, {
                         method: 'POST',
                         headers: {
                            'Content-Type': 'text/xml',
                            'SOAPAction': soapAction,
                         },
                         body: soapRequest,
                    });
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const responseText = await response.text();
                    console.log('SOAP Response:', responseText);
                    // You can parse the XML response if needed
                    const parser = new DOMParser();
                    const xmlDoc = parser.parseFromString(responseText, 'text/xml');
                    // Extract specific data from the XML response
                    const result = xmlDoc.getElementsByTagName('YourResponseTag')[0].textContent;
                    console.log('Extracted Result:', result);
                    // Handle redirection or other logic based on the response
                } catch (error) {
                    console.error('Error calling SOAP API:', error);
                }
	    }
	    //not from payment gateway - normal link click
	    else {
	    	// prepare the userAgent
            	var userAgent = navigator.userAgent || navigator.vendor || window.opera;
            	// Check if the user is on Android
            	if (/android/i.test(userAgent)) {
			if (invitationCode !== undefined && invitationCode !== null && invitationCode !== '') {
			        window.location.href = 'https://play.google.com/store/apps/details?id=io.miran.jaamwater&referrer=invitationCode=' + invitationCode;
			}
                	else {
				window.location.href = 'https://play.google.com/store/apps/details?id=io.miran.jaamwater';
			}
            	}
            	// Check if the user is on iOS
            	else if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
			if (invitationCode !== undefined && invitationCode !== null && invitationCode !== '') {
                		window.location.href = 'https://apps.apple.com/us/app/jaam-water/id1594916133?invitationCode=' + invitationCode;
			}
			else {
				window.location.href = 'https://apps.apple.com/us/app/jaam-water/id1594916133';
			}
            	}
            	// If neither, you can redirect to a generic page or show an alert
            	else {
                	// alert("This app is only available for Android and iOS devices - you might be on windows.");
                	<!-- location.href="https://isys10devsection.net/applinkHomepageNew.aspx"; -->
	        	location.href="https://isystemsdevops.github.io/JaamWater/AppLink/AppLinkWeb.html";
            	}
	    }
        }
    </script>


</head>

<body onload="redirectToStore()">
<!-- <body> -->
    <form id="form1" runat="server">

        <div class="main-wrapper"  id="">
            <div class="logostyle" style="display: grid; place-items: center;">
              <img src="https://isystemsdevops.github.io/JaamWater/AppLink/JaamWater-Icon-Transparent.png" alt="Jaam Logo" >
            </div> 
                <br />
                <br />
                <div class="col-md-3 text-center mx-auto" style="min-width:fit-content">
                    <a class="a-btn" href="https://apps.apple.com/us/app/jaam-water/id1594916133">
                        <img src="https://isystemsdevops.github.io/JaamWater/AppLink/AppStoreButton.jpg" style="border-radius: 27px" />
                    </a> 
                </div>
                <br />
                <div class="col-md-3 text-center mx-auto" style="min-width:fit-content">
                    <a  class="a-btn" href="https://play.google.com/store/apps/details?id=io.miran.jaamwater&hl=en_US&gl=US">
                        <img src="https://isystemsdevops.github.io/JaamWater/AppLink/PlayStoreButton.jpg" style="border-radius: 27px" />
                    </a> 
                </div>
        </div>
    </form>
</body>

</html>
